<!DOCTYPE html>
<html>
  <head>
    <title>cannon.js - friction demo</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
  </head>
  <body>
    <script type="module">
      import * as CANNON from '../dist/cannon-es.js'
      import { Demo } from './js/Demo.js'

      /**
       * How to set friction per material.
       */

      const demo = new Demo(),
        size = 1.0

      demo.addScene('Friction', () => {
        const shape = new CANNON.Box(new CANNON.Vec3(size, size, size))

        // Create world
        const world = demo.getWorld()
        world.broadphase = new CANNON.NaiveBroadphase()
        world.iterations = 10

        // Materials
        const groundMaterial = new CANNON.Material()
        groundMaterial.friction = 0.3

        // ground plane
        const groundShape = new CANNON.Plane()
        const groundBody = new CANNON.Body({ mass: 0, material: groundMaterial })
        groundBody.addShape(groundShape)
        world.addBody(groundBody)
        demo.addVisual(groundBody)

        // Create a slippery material (friction coefficient = 0.0)
        const slipperyMaterial = new CANNON.Material()
        slipperyMaterial.friction = 0

        // Create slippery box
        const boxBody = new CANNON.Body({ mass: 1, material: slipperyMaterial })
        boxBody.addShape(shape)
        boxBody.position.set(0, 0, 5)
        world.addBody(boxBody)
        demo.addVisual(boxBody)

        // Create box made of groundMaterial
        const boxBody2 = new CANNON.Body({ mass: 10, material: groundMaterial })
        boxBody2.addShape(shape)
        boxBody2.position.set(size * 4, 0, 5)
        world.addBody(boxBody2)
        demo.addVisual(boxBody2)

        // Change gravity so the boxes will slide along x axis
        world.gravity.set(-3, 0, -60)
      })

      demo.addScene('PerShape', () => {
        // Create world
        const world = demo.getWorld()
        world.broadphase = new CANNON.NaiveBroadphase()
        world.iterations = 10

        // Materials
        const groundMaterial = new CANNON.Material()
        groundMaterial.friction = 0.3

        // ground plane
        const groundShape = new CANNON.Plane()
        groundShape.material = groundMaterial
        const groundBody = new CANNON.Body({ mass: 0 })
        groundBody.addShape(groundShape)
        world.addBody(groundBody)
        demo.addVisual(groundBody)

        // Create a slippery material (friction coefficient = 0.0)
        const slipperyMaterial = new CANNON.Material()
        slipperyMaterial.friction = 0

        // Create slippery box - will slide on the plane
        const boxBody = new CANNON.Body({ mass: 1 })
        const shape = new CANNON.Box(new CANNON.Vec3(size, size, size))
        shape.material = slipperyMaterial
        boxBody.addShape(shape)
        boxBody.position.set(0, 0, 5)
        world.addBody(boxBody)
        demo.addVisual(boxBody)

        // Create box made of groundMaterial - will not slide on the plane
        const boxBody2 = new CANNON.Body({ mass: 10 })
        const shape2 = new CANNON.Box(new CANNON.Vec3(size, size, size))
        shape2.material = groundMaterial
        boxBody2.addShape(shape2)
        boxBody2.position.set(size * 4, 0, 5)
        world.addBody(boxBody2)
        demo.addVisual(boxBody2)

        // Change gravity so the boxes will slide along x axis
        world.gravity.set(-3, 0, -60)
      })

      demo.start()
    </script>
  </body>
</html>
